import{u as K,r as s,j as e,c as C}from"./index-CiYObJ11.js";import{c as W}from"./clientService-AuBuwhW7.js";import{u as J,M as k,B as _}from"./ClientList-wJpoalV-.js";import"./removeClass-kOFgud-U.js";import"./index-CAMJE-gR.js";const ae=()=>{const j=K(),{isMobile:w,isTablet:b,isDesktop:$}=J(),[x,D]=s.useState([]),[V,L]=s.useState(!0),[T,M]=s.useState(null),[F,S]=s.useState(!1),[A,z]=s.useState(null),[i,E]=s.useState(""),[g,H]=s.useState("all"),[R,Z]=s.useState("name"),[y,q]=s.useState("asc"),[o,u]=s.useState(1),[c,N]=s.useState(w?6:b?8:10),[Q,X]=s.useState("grid");s.useEffect(()=>{(async()=>{try{L(!0),M(null);const t=await W.getClients();let n=[];t&&t.data&&t.data.clients&&Array.isArray(t.data.clients)?n=t.data.clients:Array.isArray(t)?n=t:t&&t.data&&Array.isArray(t.data)?n=t.data:n=[],D(n)}catch(t){console.error("Error fetching clients:",t),M(t.response?.data?.message||t.message||"Failed to fetch clients")}finally{L(!1)}})()},[]),s.useEffect(()=>{N(w?6:b?8:10),u(1)},[w,b]);const f=s.useMemo(()=>{let r=x;return i&&(r=r.filter(t=>t.name.toLowerCase().includes(i.toLowerCase())||t.email.toLowerCase().includes(i.toLowerCase())||t.phone?.toLowerCase().includes(i.toLowerCase()))),g!=="all"&&(r=r.filter(t=>t.membership_tier===g)),r.sort((t,n)=>{let a,l;switch(R){case"name":a=t.name.toLowerCase(),l=n.name.toLowerCase();break;case"email":a=t.email.toLowerCase(),l=n.email.toLowerCase();break;case"createdAt":a=new Date(t.createdAt||0),l=new Date(n.createdAt||0);break;case"weight":a=t.clientProfile?.weight||0,l=n.clientProfile?.weight||0;break;default:a=t.name.toLowerCase(),l=n.name.toLowerCase()}return a<l?y==="asc"?-1:1:a>l?y==="asc"?1:-1:0}),r},[x,i,g,R,y]),B=r=>{if(!r.trim())return!1;const t=r.toLowerCase().trim();let n=x.find(a=>a.name.toLowerCase()===t);if(!n){const a=x.filter(l=>l.name.toLowerCase().includes(t)||l.email.toLowerCase().includes(t)||l.phone?.toLowerCase().includes(t));if(a.length===1)n=a[0];else if(a.length>1){const l=a.map(d=>d.name).join(", ");return C.error(`Se encontraron ${a.length} clientes: ${l}. SÃ© mÃ¡s especÃ­fico.`),!1}}if(n){const a=x.filter(d=>g!=="all"?d.membership_tier===g:!0);a.sort((d,v)=>{let m,h;switch(R){case"name":m=d.name.toLowerCase(),h=v.name.toLowerCase();break;case"email":m=d.email.toLowerCase(),h=v.email.toLowerCase();break;case"createdAt":m=new Date(d.createdAt||0),h=new Date(v.createdAt||0);break;case"weight":m=d.clientProfile?.weight||0,h=v.clientProfile?.weight||0;break;default:m=d.name.toLowerCase(),h=v.name.toLowerCase()}return m<h?y==="asc"?-1:1:m>h?y==="asc"?1:-1:0});const l=a.findIndex(d=>d.id===n.id);if(l!==-1){const d=Math.ceil((l+1)/c);return u(d),C.success(`âœ… Navegando a ${n.name} (pÃ¡gina ${d})`),setTimeout(()=>{E("")},2e3),window.scrollTo({top:0,behavior:"smooth"}),!0}}return!1},p=s.useMemo(()=>{const r=f.length,t=Math.ceil(r/c);return{currentPage:o,totalPages:t,totalItems:r,itemsPerPage:c}},[f.length,c,o]),I=s.useMemo(()=>{const r=(o-1)*c,t=r+c;return f.slice(r,t)},[f,o,c]),O=r=>{z(r),S(!0)},U=async()=>{if(A)try{await W.deleteClient(A.id),D(x.filter(r=>r.id!==A.id)),C.success("Cliente eliminado exitosamente")}catch(r){console.error("Error al eliminar cliente:",r),C.error(r.response?.data?.message||"Error al eliminar cliente")}finally{S(!1),z(null)}},Y=r=>{j(`/trainer/clients/${r}`)},G=r=>{const t=x.find(a=>a.id===r),n=t?t.name:"Cliente";j("/trainer/create-routine",{state:{clientId:r,clientName:n,assignToClient:!0}})},P=r=>{u(r),window.scrollTo({top:0,behavior:"smooth"})};return V?e.jsx("div",{className:"client-list",children:e.jsxs("div",{className:"loading-container",style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",flexDirection:"column",gap:"16px"},children:[e.jsx("div",{style:{width:"50px",height:"50px",border:"4px solid #333",borderTop:"4px solid #dc2626",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{color:"#ffffff",fontSize:"1.1rem"},children:"Cargando clientes..."})]})}):T?e.jsx("div",{className:"client-list-container",style:{backgroundColor:"#121212",minHeight:"100vh",padding:"20px"},children:e.jsxs("div",{className:"error-message",style:{textAlign:"center",padding:"60px",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px",color:"#ffffff"},children:[e.jsx("h3",{style:{color:"#ff3b30",marginBottom:"16px"},children:"Error al cargar clientes"}),e.jsx("p",{style:{marginBottom:"24px"},children:T}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"#D62828",color:"white",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:"Reintentar"})]})}):e.jsxs("div",{className:"client-list-container",style:{margin:"0",padding:"16px",width:"100%",minHeight:"100vh",backgroundColor:"#121212",color:"#ffffff"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px",marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[e.jsx("button",{onClick:()=>j("/trainer/dashboard"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"transparent",color:"#b0b0b0",border:"none",borderRadius:"8px",fontWeight:"500",cursor:"pointer"},children:"â† Volver al Dashboard"}),e.jsx("button",{onClick:()=>j("/add-client"),style:{padding:"12px 24px",background:"#D62828",color:"white",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:"+ Agregar Cliente"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h1",{style:{margin:"0",color:"#ffffff",fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"700"},children:"Mis Clientes"}),e.jsxs("p",{style:{margin:"4px 0 0 0",color:"#b0b0b0",fontSize:"0.9rem"},children:["Gestiona y supervisa a todos tus clientes (",f.length," total)"]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:w?"column":"row",gap:"16px",marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px"},children:[e.jsxs("div",{style:{flex:1,position:"relative",display:"flex",gap:"8px"},children:[e.jsx("input",{type:"text",placeholder:"Buscar cliente por nombre, email o telÃ©fono...",value:i,onChange:r=>{E(r.target.value),u(1)},onKeyDown:r=>{r.key==="Enter"&&!B(i)&&i.trim()&&C.error(`No se encontrÃ³ un cliente con el nombre exacto: "${i}"`)},style:{flex:1,padding:"12px 16px",background:"#2d2d2d",border:"1px solid #404040",borderRadius:"8px",color:"#ffffff",fontSize:"0.9rem"}}),i&&e.jsx("button",{onClick:()=>{!B(i)&&i.trim()&&C.error(`No se encontrÃ³ un cliente con el nombre exacto: "${i}"`)},style:{padding:"12px 16px",background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"500",whiteSpace:"nowrap"},children:"ðŸ” Ir a Cliente"}),i&&e.jsx("div",{style:{position:"absolute",top:"100%",left:"0",right:"0",background:"#2d2d2d",border:"1px solid #404040",borderTop:"none",borderRadius:"0 0 8px 8px",padding:"8px 12px",fontSize:"0.8rem",color:"#b0b0b0",zIndex:10},children:"ðŸ’¡ Presiona Enter o haz clic en el botÃ³n para buscar y navegar al cliente"})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsxs("select",{value:g,onChange:r=>{H(r.target.value),u(1)},style:{padding:"12px 16px",background:"#2d2d2d",border:"1px solid #404040",borderRadius:"8px",color:"#ffffff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"all",children:"Todos los tiers"}),e.jsx("option",{value:"basic",children:"BÃ¡sico"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]}),e.jsxs("select",{value:`${R}-${y}`,onChange:r=>{const[t,n]=r.target.value.split("-");Z(t),q(n),u(1)},style:{padding:"12px 16px",background:"#2d2d2d",border:"1px solid #404040",borderRadius:"8px",color:"#ffffff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"name-asc",children:"Nombre A-Z"}),e.jsx("option",{value:"name-desc",children:"Nombre Z-A"}),e.jsx("option",{value:"email-asc",children:"Email A-Z"}),e.jsx("option",{value:"email-desc",children:"Email Z-A"}),e.jsx("option",{value:"createdAt-desc",children:"MÃ¡s recientes"}),e.jsx("option",{value:"createdAt-asc",children:"MÃ¡s antiguos"})]}),e.jsxs("select",{value:c,onChange:r=>{N(Number(r.target.value)),u(1)},style:{padding:"12px 16px",background:"#2d2d2d",border:"1px solid #404040",borderRadius:"8px",color:"#ffffff",fontSize:"0.9rem"},children:[e.jsx("option",{value:6,children:"6 por pÃ¡gina"}),e.jsx("option",{value:8,children:"8 por pÃ¡gina"}),e.jsx("option",{value:10,children:"10 por pÃ¡gina"}),e.jsx("option",{value:15,children:"15 por pÃ¡gina"}),e.jsx("option",{value:20,children:"20 por pÃ¡gina"})]})]})]}),e.jsxs("div",{style:{marginBottom:"16px",padding:"0 4px",color:"#b0b0b0",fontSize:"0.9rem"},children:["Mostrando ",(o-1)*c+1," - ",Math.min(o*c,f.length)," de ",f.length," clientes",i&&` (filtrado de ${x.length} total)`]}),I.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"60px",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px"},children:[e.jsx("h3",{style:{color:"#ffffff",marginBottom:"16px"},children:i||g!=="all"?"No se encontraron clientes":"No tienes clientes aÃºn"}),e.jsx("p",{style:{color:"#b0b0b0",marginBottom:"24px"},children:i||g!=="all"?"Intenta ajustar los filtros de bÃºsqueda":"Comienza agregando tu primer cliente"}),!i&&g==="all"&&e.jsx("button",{onClick:()=>j("/add-client"),style:{padding:"12px 24px",background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",color:"white",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:"Agregar Primer Cliente"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:w?"1fr":b?"repeat(auto-fill, minmax(250px, 1fr))":$?"repeat(auto-fill, minmax(280px, 1fr))":"repeat(auto-fill, minmax(320px, 1fr))",gap:b?"12px":"16px"},children:I.map(r=>e.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px",padding:b?"16px":"24px",transition:"all 0.3s ease",display:"flex",flexDirection:"column",gap:"16px",position:"relative",overflow:"hidden",cursor:"pointer"},onMouseEnter:t=>{t.currentTarget.style.transform="translateY(-4px)",t.currentTarget.style.boxShadow="0 8px 25px rgba(220, 38, 38, 0.15)"},onMouseLeave:t=>{t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem",fontWeight:"700",margin:"0 auto"},children:r.name.charAt(0).toUpperCase()}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:"1.25rem",fontWeight:"600"},children:r.name}),e.jsx("p",{style:{margin:"0 0 4px 0",color:"#b0b0b0",fontSize:"0.9rem"},children:r.email}),r.phone&&e.jsx("p",{style:{margin:"0 0 12px 0",color:"#b0b0b0",fontSize:"0.9rem"},children:r.phone}),r.membership_tier&&e.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"20px",fontSize:"0.8rem",fontWeight:"600",textTransform:"uppercase",background:r.membership_tier==="premium"?"rgba(214, 40, 40, 0.2)":r.membership_tier==="pro"?"rgba(245, 158, 11, 0.2)":"rgba(156, 163, 175, 0.2)",color:r.membership_tier==="premium"?"#D62828":r.membership_tier==="pro"?"#f59e0b":"#9ca3af"},children:r.membership_tier.charAt(0).toUpperCase()+r.membership_tier.slice(1)})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto"},children:[e.jsx("button",{onClick:()=>Y(r.id),style:{padding:"10px 16px",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",transition:"all 0.3s ease",textAlign:"center",background:"#D62828",color:"white"},children:"Ver Perfil"}),e.jsx("button",{onClick:()=>G(r.id),style:{padding:"10px 16px",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",transition:"all 0.3s ease",textAlign:"center",background:"#D62828",color:"white"},children:"Asignar Rutina"}),e.jsx("button",{onClick:()=>O(r),style:{padding:"10px 16px",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",transition:"all 0.3s ease",textAlign:"center",background:"#D62828",color:"white"},children:"Eliminar"})]})]},r.id))}),p.totalPages>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",marginTop:"32px",padding:"16px",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px"},children:[e.jsx("button",{onClick:()=>P(o-1),disabled:o===1,style:{padding:"8px 12px",background:o===1?"#404040":"#D62828",color:o===1?"#666":"white",border:"none",borderRadius:"6px",cursor:o===1?"not-allowed":"pointer"},children:"â† Anterior"}),e.jsx("div",{style:{display:"flex",gap:"4px"},children:Array.from({length:Math.min(5,p.totalPages)},(r,t)=>{let n;return p.totalPages<=5||o<=3?n=t+1:o>=p.totalPages-2?n=p.totalPages-4+t:n=o-2+t,e.jsx("button",{onClick:()=>P(n),style:{padding:"8px 12px",background:n===o?"#D62828":"#404040",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:n===o?"600":"400"},children:n},n)})}),e.jsx("button",{onClick:()=>P(o+1),disabled:o===p.totalPages,style:{padding:"8px 12px",background:o===p.totalPages?"#404040":"#D62828",color:o===p.totalPages?"#666":"white",border:"none",borderRadius:"6px",cursor:o===p.totalPages?"not-allowed":"pointer"},children:"Siguiente â†’"}),e.jsxs("div",{style:{marginLeft:"16px",color:"#b0b0b0",fontSize:"0.9rem"},children:["PÃ¡gina ",o," de ",p.totalPages]})]})]}),e.jsxs(k,{show:F,onHide:()=>S(!1),centered:!0,children:[e.jsx(k.Header,{closeButton:!0,style:{backgroundColor:"#1a1a1a",borderColor:"#404040"},children:e.jsx(k.Title,{style:{color:"#ffffff"},children:"Confirmar eliminaciÃ³n"})}),e.jsxs(k.Body,{style:{backgroundColor:"#1a1a1a",color:"#ffffff"},children:["Â¿EstÃ¡s seguro de que quieres eliminar a ",A?.name,"? Esta acciÃ³n no se puede deshacer."]}),e.jsxs(k.Footer,{style:{backgroundColor:"#1a1a1a",borderColor:"#404040"},children:[e.jsx(_,{variant:"secondary",onClick:()=>S(!1),style:{backgroundColor:"#404040",borderColor:"#404040"},children:"Cancelar"}),e.jsx(_,{variant:"danger",onClick:U,style:{backgroundColor:"#dc2626",borderColor:"#dc2626"},children:"Eliminar"})]})]}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})};export{ae as default};
