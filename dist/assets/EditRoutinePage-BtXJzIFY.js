import{u as P,e as M,r as c,j as e}from"./index-CiYObJ11.js";import{a as B}from"./api-BeJd8zh7.js";import{E as U,b as H,c as O,a as V,d as G,e as J,f as K,g as Q,h as X,i as Y,j as Z,m as ee,p as se,k as ae,l as re,t as te,n as oe}from"./tricepsExercises-B5e31P2L.js";const{trainerApi:v}=B,de=()=>{const j=P(),{routineId:f}=M(),[C,S]=c.useState([]),[l,x]=c.useState({name:"",clientId:"",duration:"",notes:"",exercises:[],totalWeeks:4}),[w,_]=c.useState([]),[ne,I]=c.useState([]),[b,g]=c.useState([]),[d,u]=c.useState([]),[y,m]=c.useState(null),[N,E]=c.useState(null),[R,$]=c.useState(!0),k=c.useRef([]);c.useEffect(()=>{(async()=>{try{if(!localStorage.getItem("token")){m("Usuario no autenticado. Por favor, inicia sesión.");return}const n=(await v.getClients()).data||[];if(Array.isArray(n)){const o=n.map(r=>({id:r.id,name:r.name||r.email}));S(o)}if(f)try{const r=(await v.getRoutineById(f)).data;x({name:r.name||"",clientId:r.clientId||"",duration:r.duration||"",notes:r.notes||"",exercises:r.exercises||[],totalWeeks:typeof r.totalWeeks=="number"&&!isNaN(r.totalWeeks)?r.totalWeeks:4});const F=r.exercises?.map(L=>L.name||"")||[];g(F),u(new Array(r.exercises?.length||0).fill(!1))}catch(o){console.error("Error al cargar la rutina:",o),m("Error al cargar la rutina. Intenta de nuevo más tarde.")}const i=[...H.map((o,r)=>({...o,id:`biceps_${r}`})),...O.map((o,r)=>({...o,id:`cardio_${r}`})),...V.map((o,r)=>({...o,id:`circuito_${r}`})),...G.map((o,r)=>({...o,id:`core_${r}`})),...J.map((o,r)=>({...o,id:`dorsales_${r}`})),...K.map((o,r)=>({...o,id:`espinales_${r}`})),...Q.map((o,r)=>({...o,id:`gemelos_${r}`})),...X.map((o,r)=>({...o,id:`gluteo_${r}`})),...Y.map((o,r)=>({...o,id:`hombros_${r}`})),...Z.map((o,r)=>({...o,id:`isquios_${r}`})),...ee.map((o,r)=>({...o,id:`movilidad_${r}`})),...se.map((o,r)=>({...o,id:`pectorales_${r}`})),...ae.map((o,r)=>({...o,id:`piernas_${r}`})),...re.map((o,r)=>({...o,id:`potencia_${r}`})),...te.map((o,r)=>({...o,id:`triceps_${r}`}))];_(i),I(i)}catch(s){console.error("Error fetching data:",s),m("Error al cargar los datos. Intenta de nuevo más tarde.")}finally{$(!1)}})()},[f]),c.useEffect(()=>{const t=s=>{k.current.forEach((a,n)=>{if(a&&!a.contains(s.target)){const i=[...d];i[n]=!1,u(i)}})};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[d]);const h=t=>{const{name:s,value:a}=t.target;x(n=>({...n,[s]:s==="totalWeeks"?Math.max(1,parseInt(a||"4",10)):a}))},D=(t,s)=>{const a=[...b],n=[...d];a[t]=s,n[t]=s.length>0,g(a),u(n)},z=t=>{const s=b[t]?.toLowerCase()||"";return s===""?w:w.filter(a=>(a.name?a.name.toLowerCase():"").includes(s))},A=(t,s)=>{const a=[...b],n=[...d];a[t]=s.name,n[t]=!1,g(a),u(n);const i=[...l.exercises];i[t]={...i[t],exerciseId:s.id,name:s.name,image_url:s.image_url||oe(s.name)},x(o=>({...o,exercises:i}))},p=(t,s)=>{const{name:a,value:n}=s.target,i=[...l.exercises];i[t]&&(i[t]={...i[t],[a]:n},x(o=>({...o,exercises:i})))},W=()=>{const t={id:`exercise_${Date.now()}`,exerciseId:"",name:"",series:"",reps:"",weight:"",notes:"",day:1};x(s=>({...s,exercises:[...s.exercises,t]})),g([...b,""]),u([...d,!1])},q=t=>{x(s=>({...s,exercises:s.exercises.filter((a,n)=>n!==t)})),g(b.filter((s,a)=>a!==t)),u(d.filter((s,a)=>a!==t))},T=async t=>{if(t.preventDefault(),m(null),E(null),!l.name||!l.clientId||!l.duration){m("Por favor, completa todos los campos obligatorios.");return}if(l.exercises.length===0){m("Debes agregar al menos un ejercicio a la rutina.");return}try{await v.updateRoutine(f,l),E("✅ Rutina actualizada exitosamente!"),setTimeout(()=>{j("/trainer-dashboard")},2e3)}catch(s){console.error("Error updating routine:",s),m(s.message||"Error al actualizar la rutina. Intenta de nuevo.")}};return R?e.jsx("div",{className:"min-h-screen bg-[#0a0a0a] flex items-center justify-center",children:e.jsx("div",{className:"text-white text-xl",children:"Cargando rutina..."})}):e.jsx("div",{className:"min-h-screen bg-[#0a0a0a] text-white",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>j(-1),className:"bg-[#1a1a1a] hover:bg-[#2a2a2a] text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 border border-[#555555] hover:border-[#777777]",children:"← Volver"}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent",children:"Editar Rutina"})]})}),y&&e.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg mb-6",children:y}),N&&e.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-400 px-4 py-3 rounded-lg mb-6",children:N}),e.jsxs("form",{onSubmit:T,className:"space-y-8",children:[e.jsxs("div",{className:"bg-[#1a1a1a] border border-[#555555] rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-white",children:"Información de la Rutina"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Nombre de la Rutina ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:h,className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: Rutina de Fuerza - Semana 1",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Cliente ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{name:"clientId",value:l.clientId,onChange:h,className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",required:!0,children:[e.jsx("option",{value:"",children:"Selecciona un cliente"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Duración ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"duration",value:l.duration,onChange:h,className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: 4 semanas, 45 minutos",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Total de semanas"}),e.jsx("input",{type:"number",name:"totalWeeks",min:1,value:typeof l.totalWeeks=="number"?l.totalWeeks:4,onChange:h,className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: 4"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Notas Adicionales"}),e.jsx("textarea",{name:"notes",value:l.notes,onChange:h,rows:3,className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300 resize-none",placeholder:"Instrucciones especiales, objetivos, etc..."})]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] border border-[#555555] rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Ejercicios"}),e.jsx("button",{type:"button",onClick:W,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105",children:"+ Agregar Ejercicio"})]}),e.jsxs("div",{className:"space-y-6",children:[l.exercises.map((t,s)=>e.jsxs("div",{className:"bg-[#1a1a1a] border border-[#555555] rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-sm font-bold",children:s+1}),"Ejercicio ",s+1]}),e.jsx("button",{type:"button",onClick:()=>q(s),className:"bg-[#dc3545]/20 hover:bg-[#dc3545] text-[#dc3545] hover:text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 border border-[#dc3545]/30 hover:border-[#dc3545]",children:"Eliminar"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",ref:a=>k.current[s]=a,children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Ejercicio ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:b[s]||"",onChange:a=>D(s,a.target.value),onFocus:()=>{const a=[...d];a[s]=!0,u(a)},className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Buscar ejercicio...",required:!0}),d[s]&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-[#2a2a2a] border border-[#555555] rounded-lg shadow-lg max-h-60 overflow-y-auto",children:z(s).slice(0,10).map(a=>e.jsx("div",{onClick:()=>A(s,a),className:"px-4 py-2 hover:bg-[#3a3a3a] cursor-pointer text-white border-b border-[#444444] last:border-b-0",children:a.name},a.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Series ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"series",value:t.series,onChange:a=>p(s,a),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: 3",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Repeticiones ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"reps",value:t.reps,onChange:a=>p(s,a),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: 12",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Peso (opcional)"}),e.jsx("input",{type:"text",name:"weight",value:t.weight||"",onChange:a=>p(s,a),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",placeholder:"Ej: 20kg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Día"}),e.jsx("select",{name:"day",value:t.day||1,onChange:a=>p(s,a),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#555555] rounded-lg text-white focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300",children:[1,2,3,4,5,6,7].map(a=>e.jsxs("option",{value:a,children:["Día ",a]},a))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Notas del Ejercicio"}),e.jsx("textarea",{name:"notes",value:t.notes||"",onChange:a=>p(s,a),rows:3,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#555555] rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-[#ff4444] focus:border-[#ff4444] transition-all duration-300 resize-none",placeholder:"Notas adicionales sobre este ejercicio..."})]}),t.image_url&&e.jsx("div",{className:"mt-4",children:e.jsx(U,{exerciseName:t.name,width:128,height:128,className:"rounded-lg",alt:t.name})})]},t.id)),l.exercises.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("p",{className:"text-lg mb-4",children:"No hay ejercicios agregados"}),e.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Ejercicio" para comenzar'})]})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>j(-1),className:"bg-[#1a1a1a] hover:bg-[#2a2a2a] text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300 border border-[#555555] hover:border-[#777777]",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105",children:"Actualizar Rutina"})]})]})]})})})};export{de as default};
