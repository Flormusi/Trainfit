import{e as L,u as I,h as A,a as V,r as l,j as e,b as f}from"./index-CiYObJ11.js";const q=()=>{const{routineId:o,clientId:B}=L(),m=I(),r=A(),{user:P}=V(),[t,y]=l.useState(null),[g,j]=l.useState(!0),[N,E]=l.useState(null),[d,v]=l.useState(1),[i,b]=l.useState(null),u=r.pathname.includes("/trainer/");r.pathname.includes("/client/"),l.useEffect(()=>{(async()=>{try{j(!0);let a;u?a=`/trainer/routines/${o}`:a=`/routines/${o}`;const n=(await f.get(a))?.data??{};y(n.data||n)}catch(a){E(a.message)}finally{j(!1)}})()},[o,u]);const D=s=>{if(typeof s=="number")return s||1;if(typeof s=="string"){const a=parseInt(s,10);return Number.isNaN(a)?1:a}return 1},{exercisesByDay:p,days:h}=l.useMemo(()=>{const s={};(Array.isArray(t?.exercises)?t.exercises:[]).forEach(n=>{const x=D(n?.day);s[x]||(s[x]=[]),s[x].push(n)});const c=Object.keys(s).map(n=>parseInt(n,10)).sort((n,x)=>n-x);return{exercisesByDay:s,days:c}},[t]);l.useEffect(()=>{h.length>0&&!h.includes(d)&&v(h[0])},[h]);const w=s=>{v(s)},R=s=>{b(s)},k=()=>{b(null)},C=()=>{u?m(`/trainer/routines/${o}/edit`):alert("Solo los entrenadores pueden editar rutinas.")},S=async()=>{if(window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar la rutina "${t.name}"?

Esta acciÃ³n no se puede deshacer.`))try{let a;u?a=`/trainer/routines/${o}`:a=`/client/routines/${o}`,await f.delete(a),alert(`âœ… Rutina "${t.name}" eliminada exitosamente.`);const c=r.state&&r.state.fromLibrary||!1,n=r.state&&r.state.folder;c?m("/trainer/routines/library",{state:{folder:n}}):m(-1)}catch(a){console.error("Error al eliminar la rutina:",a),alert("âŒ Error al eliminar la rutina. Por favor, intÃ©ntalo de nuevo.")}},$=s=>{if(!s)return null;const a=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,c=s.match(a);return c&&c[2].length===11?`https://www.youtube.com/embed/${c[2]}`:null};return g?e.jsx("div",{className:"loading",children:"Loading..."}):N?e.jsx("div",{className:"error-message",children:N}):t?e.jsxs("div",{className:"routine-details",children:[e.jsxs("div",{className:"details-header",children:[e.jsx("button",{className:"back-button",onClick:()=>{const s=r.state&&r.state.fromLibrary||!1,a=r.state&&r.state.folder;s?m("/trainer/routines/library",{state:{folder:a}}):m(-1)},children:r.state&&r.state.fromLibrary?"â† Volver a la biblioteca":"â† Volver"}),e.jsx("div",{className:"header-title",children:e.jsx("h1",{children:t.name})}),e.jsx("div",{className:"header-actions",children:u&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn edit-btn",title:"Editar rutina",onClick:C,children:"âœï¸ Editar"}),e.jsx("button",{className:"action-btn delete-btn",title:"Eliminar rutina",onClick:S,children:"ðŸ—‘ï¸ Eliminar"})]})})]}),e.jsxs("div",{className:"routine-meta-info",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"DuraciÃ³n:"}),e.jsxs("span",{className:"meta-value",children:[t.duration||4," semanas"]})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Objetivo:"}),e.jsx("span",{className:"meta-value",children:t.goal||"No especificado"})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Nivel:"}),e.jsx("span",{className:"meta-value",children:t.level||"Intermedio"})]})]}),e.jsx("div",{className:"routine-description",children:e.jsx("p",{children:t.description})}),e.jsx("div",{className:"days-tabs",children:h.map(s=>e.jsxs("button",{className:`day-tab ${d===s?"active":""}`,onClick:()=>w(s),children:["DÃ­a ",s]},s))}),e.jsxs("div",{className:"day-exercises",children:[e.jsxs("h2",{children:["Ejercicios - DÃ­a ",d]}),!p[d]||p[d].length===0?e.jsx("p",{className:"no-exercises",children:"No hay ejercicios para este dÃ­a"}):e.jsx("div",{className:"exercises-list",children:p[d].map((s,a)=>e.jsxs("div",{className:"exercise-item",onClick:()=>R(s),children:[e.jsx("div",{className:"exercise-number",children:a+1}),e.jsxs("div",{className:"exercise-content",children:[e.jsx("h3",{children:s.name}),e.jsxs("div",{className:"exercise-details",children:[e.jsxs("span",{className:"exercise-sets",children:[s.sets," series"]}),e.jsxs("span",{className:"exercise-reps",children:[s.reps," repeticiones"]}),s.rest&&e.jsxs("span",{className:"exercise-rest",children:[s.rest,"s descanso"]})]}),e.jsx("p",{className:"exercise-notes",children:s.notes})]}),e.jsx("div",{className:"exercise-actions",children:e.jsx("button",{className:"view-details-btn",children:"Ver detalles"})})]},a))})]}),i&&e.jsx("div",{className:"exercise-details-overlay",children:e.jsxs("div",{className:"exercise-details",children:[e.jsx("button",{className:"close-details-btn",onClick:k,children:"âœ•"}),e.jsx("h2",{children:i.name}),i.videoUrl&&e.jsx("div",{className:"video-container",children:e.jsx("iframe",{src:$(i.videoUrl),title:i.name,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),e.jsxs("div",{className:"exercise-instructions",children:[e.jsx("h3",{children:"Instrucciones"}),e.jsx("p",{children:i.instructions||"No hay instrucciones disponibles para este ejercicio."})]}),e.jsxs("div",{className:"exercise-prescription",children:[e.jsx("h3",{children:"PrescripciÃ³n"}),e.jsxs("div",{className:"prescription-details",children:[e.jsxs("div",{className:"prescription-item",children:[e.jsx("span",{className:"prescription-label",children:"Series:"}),e.jsx("span",{className:"prescription-value",children:i.sets})]}),e.jsxs("div",{className:"prescription-item",children:[e.jsx("span",{className:"prescription-label",children:"Repeticiones:"}),e.jsx("span",{className:"prescription-value",children:i.reps})]}),i.rest&&e.jsxs("div",{className:"prescription-item",children:[e.jsx("span",{className:"prescription-label",children:"Descanso:"}),e.jsxs("span",{className:"prescription-value",children:[i.rest," segundos"]})]}),i.tempo&&e.jsxs("div",{className:"prescription-item",children:[e.jsx("span",{className:"prescription-label",children:"Tempo:"}),e.jsx("span",{className:"prescription-value",children:i.tempo})]})]})]}),i.notes&&e.jsxs("div",{className:"exercise-notes-section",children:[e.jsx("h3",{children:"Notas"}),e.jsx("p",{children:i.notes})]}),e.jsx("div",{className:"record-progress-section",children:e.jsx("button",{className:"record-progress-btn",children:"Registrar progreso"})})]})})]}):e.jsx("div",{className:"error-message",children:"Routine not found"})};export{q as default};
