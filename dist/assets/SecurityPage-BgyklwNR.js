import{r as t,j as e,b as x}from"./index-CiYObJ11.js";function p({title:r,titleId:a,...n},i){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":a},n),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const h=t.forwardRef(p),m=()=>{const[r,a]=t.useState([]),[n,i]=t.useState(!0),[l,d]=t.useState(null);return t.useEffect(()=>{(async()=>{try{i(!0),d(null);const s=await x.get("/security/token-rotations",{params:{limit:100}});a(s.data.rotations||[])}catch(s){const c=s?.response?.data?.message||s?.message||"Error inesperado";d(c)}finally{i(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:960,margin:"0 auto",padding:24,color:"#fff"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:[e.jsx(h,{style:{width:24,height:24,color:"#E63946",marginRight:8}}),e.jsx("h1",{style:{margin:0},children:"Seguridad — Historial de Rotaciones"})]}),e.jsxs("p",{style:{color:"#94a3b8",marginTop:0},children:["Este listado muestra las rotaciones de ",e.jsx("code",{children:"APPROVAL_TOKEN"})," registradas por el script de operaciones."]}),n&&e.jsx("div",{children:"Cargando historial..."}),l&&e.jsxs("div",{style:{color:"#ff5555"},children:["Error: ",l]}),!n&&!l&&(r.length===0?e.jsx("div",{style:{color:"#94a3b8"},children:"No hay registros aún."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #333"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 12px"},children:"Fecha"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 12px"},children:"Entorno"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 12px"},children:"Rotado por"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 12px"},children:"Token (enmascarado)"})]})}),e.jsx("tbody",{children:r.map((o,s)=>e.jsxs("tr",{style:{borderBottom:"1px solid #222"},children:[e.jsx("td",{style:{padding:"8px 12px",color:"#ddd"},children:new Date(o.timestamp).toLocaleString()}),e.jsx("td",{style:{padding:"8px 12px"},children:o.env}),e.jsx("td",{style:{padding:"8px 12px"},children:o.rotated_by}),e.jsx("td",{style:{padding:"8px 12px",fontFamily:"monospace"},children:o.token_masked})]},s))})]})})),e.jsxs("div",{style:{marginTop:24,color:"#94a3b8"},children:['Para rotar manualmente en CI/CD, usa el workflow "Manual Approval Token Rotation" con ',e.jsx("em",{children:"workflow_dispatch"}),"."]})]})};export{m as default};
